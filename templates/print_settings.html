{% extends "base.html" %}

{% block title %}Print Layout Settings{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>⚙️ System Settings</h2>
    
    <div class="row mt-4">
        <div class="col-md-3">
            <div class="list-group">
                <a href="{{ url_for('settings') }}" class="list-group-item list-group-item-action">
                    <i class="fas fa-cog"></i> System Settings
                </a>
                <a href="{{ url_for('profile_settings') }}" class="list-group-item list-group-item-action">
                    <i class="fas fa-user"></i> My Profile
                </a>
                <a href="{{ url_for('notification_settings') }}" class="list-group-item list-group-item-action">
                    <i class="fas fa-bell"></i> Notifications
                </a>
                <a href="{{ url_for('print_settings') }}" class="list-group-item list-group-item-action active">
                    <i class="fas fa-print"></i> Print Layout
                </a>
                <a href="{{ url_for('backup_settings') }}" class="list-group-item list-group-item-action">
                    <i class="fas fa-database"></i> Backups
                </a>
                <a href="{{ url_for('data_import') }}" class="list-group-item list-group-item-action">
                    <i class="fas fa-file-import"></i> Data Import
                </a>
                <a href="{{ url_for('test_whatsapp') }}" class="list-group-item list-group-item-action">
                    <i class="fab fa-whatsapp"></i> Test WhatsApp
                </a>
            </div>
        </div>
        
        <div class="col-md-9">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-print"></i> Print Layout Configuration</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('update_print_settings') }}" enctype="multipart/form-data">
                        
                        <!-- Company Information Section -->
                        <div class="mb-4">
                            <h5 class="text-primary border-bottom pb-2">
                                <i class="fas fa-building"></i> Company Information
                            </h5>
                            
                            <div class="mb-3">
                                <label for="company_name" class="form-label">Company Name *</label>
                                <input type="text" class="form-control" id="company_name" name="company_name" 
                                       value="{{ print_config.company_name if print_config else 'Fleet Management System' }}" required>
                                <small class="text-muted">This will appear in the header of printed documents</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="company_tagline" class="form-label">Tagline / Slogan</label>
                                <input type="text" class="form-control" id="company_tagline" name="company_tagline" 
                                       value="{{ print_config.company_tagline if print_config else 'Efficient Fleet Operations' }}">
                                <small class="text-muted">A brief tagline that describes your company</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="company_address" class="form-label">Address</label>
                                <textarea class="form-control" id="company_address" name="company_address" rows="2">{{ print_config.company_address if print_config else '' }}</textarea>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="company_phone" class="form-label">Phone</label>
                                    <input type="text" class="form-control" id="company_phone" name="company_phone" 
                                           value="{{ print_config.company_phone if print_config else '' }}">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="company_email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="company_email" name="company_email" 
                                           value="{{ print_config.company_email if print_config else '' }}">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="company_website" class="form-label">Website</label>
                                <input type="text" class="form-control" id="company_website" name="company_website" 
                                       value="{{ print_config.company_website if print_config else '' }}">
                            </div>
                        </div>

                        <!-- Logo Upload Section -->
                        <div class="mb-4">
                            <h5 class="text-primary border-bottom pb-2">
                                <i class="fas fa-image"></i> Company Logo
                            </h5>
                            
                            {% if print_config and print_config.logo_path %}
                            <div class="mb-3">
                                <p><strong>Current Logo:</strong></p>
                                <img src="{{ url_for('static', filename=print_config.logo_path) }}" 
                                     alt="Company Logo" style="max-width: 200px; max-height: 100px; border: 1px solid #ddd; padding: 10px;">
                            </div>
                            {% endif %}
                            
                            <div class="mb-3">
                                <label for="logo" class="form-label">Upload New Logo</label>
                                <input type="file" class="form-control" id="logo" name="logo" accept="image/png,image/jpeg,image/jpg">
                                <small class="text-muted">Recommended: PNG or JPG, max 2MB. Ideal size: 300x150 pixels</small>
                            </div>
                            
                            {% if print_config and print_config.logo_path %}
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="remove_logo" name="remove_logo">
                                <label class="form-check-label" for="remove_logo">
                                    Remove current logo
                                </label>
                            </div>
                            {% endif %}
                        </div>

                        <!-- Footer Configuration -->
                        <div class="mb-4">
                            <h5 class="text-primary border-bottom pb-2">
                                <i class="fas fa-align-center"></i> Footer Configuration
                            </h5>
                            
                            <div class="mb-3">
                                <label for="footer_left" class="form-label">Footer Left Text</label>
                                <input type="text" class="form-control" id="footer_left" name="footer_left" 
                                       value="{{ print_config.footer_left if print_config else 'Printed by: {username}' }}">
                                <small class="text-muted">Use {username} to insert current user's name</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="footer_center" class="form-label">Footer Center Text</label>
                                <input type="text" class="form-control" id="footer_center" name="footer_center" 
                                       value="{{ print_config.footer_center if print_config else 'Page {page}' }}">
                                <small class="text-muted">Use {page} for page number</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="footer_right" class="form-label">Footer Right Text</label>
                                <input type="text" class="form-control" id="footer_right" name="footer_right" 
                                       value="{{ print_config.footer_right if print_config else 'Confidential Document' }}">
                            </div>
                        </div>

                        <!-- Preview Section -->
                        <div class="mb-4">
                            <h5 class="text-primary border-bottom pb-2">
                                <i class="fas fa-eye"></i> Preview
                            </h5>
                            <p class="text-muted">Click the button below to see how your print layout will look:</p>
                            <a href="{{ url_for('service_notifications_print') }}" class="btn btn-info" target="_blank">
                                <i class="fas fa-external-link-alt"></i> Print Preview
                            </a>
                        </div>

                        <div class="d-flex justify-content-between">
                            <a href="{{ url_for('settings') }}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Back
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Save Print Settings
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Information Card -->
            <div class="card mt-3">
                <div class="card-header bg-info text-white">
                    <h6 class="mb-0"><i class="fas fa-info-circle"></i> Information</h6>
                </div>
                <div class="card-body">
                    <p><strong>Print Layout System</strong></p>
                    <p>Configure your company information and branding for all printed documents including:</p>
                    <ul>
                        <li>Service Due Notifications Reports</li>
                        <li>Job Cards</li>
                        <li>Service Requisitions</li>
                        <li>Vehicle Reports</li>
                    </ul>
                    <p class="mb-0 text-muted"><small>Changes will apply to all future printed documents.</small></p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
